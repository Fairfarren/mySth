webpackJsonp([2],{"2yzT":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("KH7x"),r=a.n(n),o=a("4YfN"),s=a.n(o),i=a("9rMa"),c={data:function(){return{showName:!1,showSex:!1,showTime:!1,formData:{name:"",sex:"",birthday:""},minHour:10,maxHour:20,minDate:new Date(1919,1,1),maxDate:new Date(2018,0,1),currentDate:new Date(2018,0,1)}},computed:s()({},Object(i.b)(["USERSEX"])),methods:{getUserSth:function(){this.formData.name=this.$store.state.USER.username,this.formData.sex=this.$store.state.USER.sex,this.formData.birthday=this.$store.state.USER.birthday;var t=this.formData.birthday.split("-"),e=r()(t,3),a=e[0],n=e[1],o=e[2];this.currentDate=new Date(a,n-1,o)},changeImg:function(t){var e=t.target.files||t.dataTransfer.files;console.log(e),"image/jpg"!==e[0].type&&"image/png"!==e[0].type&&"image/bmp"!==e[0].type&&"image/jpeg"!==e[0].type?this.Toast.fail("图片格式错误"):e.size>4194304?this.Toast.fail("图片最大4M"):this.setUserSth()},changeName:function(){this.showName=!0,setTimeout(function(){document.querySelector("#changeUserName").focus()},300)},changeBirthday:function(t){this.showTime=!1,this.formData.birthday=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate(),this.setUserSth()},setUserSth:function(){var t=this,e=new FormData;e.append("username",this.formData.name),e.append("birthday",this.formData.birthday),e.append("sex",this.formData.sex);var a=this.$refs.img.files[0];a&&e.append("avatar",a),this.axios({url:"/wx/edit_profile",method:"put",headers:{"Content-Type":"multipart/form-data"},data:e}).then(function(e){t.showSex=!1,201===e.data.status_code?(t.Toast.success(e.data.msg),t.$store.dispatch("GET_USER_INFO")):401===e.data.status_code?t.$store.commit("NOW401"):t.Toast.fail(e.data.msg)}).catch(function(e){console.log(e),t.Toast.fail("网络连接错误")})}},mounted:function(){var t=this;setTimeout(function(){t.getUserSth()},1e3);var e=new Date;this.maxDate=new Date(e.getFullYear(),e.getMonth(),e.getDate())},watch:{showName:function(t){!t&&this.formData.name!==this.$store.state.USER.username&&this.setUserSth()}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"top"},[a("p",[a("img",{attrs:{src:this.$store.state.USER.avatar,alt:""}}),t._v(" "),a("input",{ref:"img",attrs:{type:"file"},on:{change:function(e){t.changeImg(e)}}})]),t._v(" "),a("p",[t._v("\n      "+t._s(this.$store.state.USER.username)+"\n    ")])]),t._v(" "),a("div",{staticClass:"bottom"},[a("ul",[a("li",{on:{click:t.changeName}},[a("span",[t._v("\n          昵称：\n        ")]),t._v(" "),a("span",[t._v("\n          "+t._s(t.formData.name)+"\n        ")])]),t._v(" "),a("li",{on:{click:function(e){t.showSex=!0}}},[a("span",[t._v("\n          性别：\n        ")]),t._v(" "),a("span",[t._v("\n          "+t._s(t.USERSEX)+"\n        ")])]),t._v(" "),a("li",{on:{click:function(e){t.showTime=!0}}},[a("span",[t._v("\n          生日：\n        ")]),t._v(" "),a("span",[t._v("\n          "+t._s(t.formData.birthday)+"\n        ")])])])]),t._v(" "),a("div",[a("van-actionsheet",{staticClass:"popp",model:{value:t.showName,callback:function(e){t.showName=e},expression:"showName"}},[a("van-field",{attrs:{placeholder:"请输入用户名",label:"昵称：",id:"changeUserName"},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.showName=!1}},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),t._v(" "),a("van-actionsheet",{staticClass:"popp",model:{value:t.showSex,callback:function(e){t.showSex=e},expression:"showSex"}},[a("p",{on:{click:function(e){t.formData.sex=1,t.setUserSth()}}},[t._v("男")]),t._v(" "),a("p",{on:{click:function(e){t.formData.sex=0,t.setUserSth()}}},[t._v("女")]),t._v(" "),a("p",{on:{click:function(e){t.formData.sex=2,t.setUserSth()}}},[t._v("未知")])]),t._v(" "),a("van-actionsheet",{staticClass:"popp",model:{value:t.showTime,callback:function(e){t.showTime=e},expression:"showTime"}},[a("van-datetime-picker",{attrs:{type:"date","min-hour":t.minHour,"max-hour":t.maxHour,"min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.changeBirthday},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)])},staticRenderFns:[]};var f=a("X4nt")(c,u,!1,function(t){a("3K9J")},"data-v-5d75c168",null);e.default=f.exports},"3K9J":function(t,e){},FsTu:function(t,e,a){a("dmd9"),a("wCtA"),t.exports=a("Lo5Z")},HzJ8:function(t,e,a){t.exports={default:a("aSM5"),__esModule:!0}},KH7x:function(t,e,a){"use strict";e.__esModule=!0;var n=o(a("MGgt")),r=o(a("HzJ8"));function o(t){return t&&t.__esModule?t:{default:t}}e.default=function(){return function(t,e){if(Array.isArray(t))return t;if((0,n.default)(Object(t)))return function(t,e){var a=[],n=!0,o=!1,s=void 0;try{for(var i,c=(0,r.default)(t);!(n=(i=c.next()).done)&&(a.push(i.value),!e||a.length!==e);n=!0);}catch(t){o=!0,s=t}finally{try{!n&&c.return&&c.return()}finally{if(o)throw s}}return a}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},Lo5Z:function(t,e,a){var n=a("iKyp"),r=a("QjZ5")("iterator"),o=a("9mma");t.exports=a("UusJ").isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||o.hasOwnProperty(n(e))}},MGgt:function(t,e,a){t.exports={default:a("FsTu"),__esModule:!0}},X6b2:function(t,e,a){var n=a("iKyp"),r=a("QjZ5")("iterator"),o=a("9mma");t.exports=a("UusJ").getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||o[n(t)]}},aSM5:function(t,e,a){a("dmd9"),a("wCtA"),t.exports=a("rLQK")},iKyp:function(t,e,a){var n=a("BLKo"),r=a("QjZ5")("toStringTag"),o="Arguments"==n(function(){return arguments}());t.exports=function(t){var e,a,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(a=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?a:o?n(e):"Object"==(s=n(e))&&"function"==typeof e.callee?"Arguments":s}},rLQK:function(t,e,a){var n=a("Dc6E"),r=a("X6b2");t.exports=a("UusJ").getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return n(e.call(t))}}});
//# sourceMappingURL=2.765db96a7d2a2f186479.js.map